<html>

<head>
    <title>Frappe</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="index.css">
    <meta name="viewport" content="width=320, initial-scale=1">

</head>

<body>

    <img id="image">

    <h1> Frappe! Score :<span class="score"> 0 </span></h1>
    <button class="button" onclick="startGame()">Commence !</button>
    <p>Multiplicateur <span class="multiplicateur"> 1 </span></p>
    <div class="game">
        <div class="trou trou1">
            <div id="photo" class="romain alex"></div>
        </div>
        <div class="trou trou2">
            <div id="photo" class="romain benoit"></div>
        </div>
        <div class="trou trou3">
            <div id="photo" class="romain"></div>
        </div>
        <div class="trou trou4">
            <div id="photo" class="romain benoit"></div>
        </div>
        <div class="trou trou5">
            <div id="photo" class="romain"></div>
        </div>
        <div class="trou trou6">
            <div id="photo" class="romain alex"></div>
        </div>
    </div>

    <script>
        const trous = document.querySelectorAll(
            '.trou'); // Je selectionne tous les "trou" que je nomme dans une constante "trous"
        const scoreBoard = document.querySelector(
            '.score'); // Je selectionne le score que je nomme ScoreBoard, qui lui va changer(constante)
        const romains = document.querySelectorAll(
            '.romain'); // Je selectionne tous les "romains" dans une constante nommée "romains"
        const multiplie = document.querySelector('.multiplicateur');
        let dernierTrou; // Déclare une variable limitée au bloc trou
        let timeUp = false; // Pour dire que la variable ne se termine pas au départ
        let score = 0; //On dit que le score est à 0.
        let multiplicateur = 1; // On dit que le multiplicateur comme à 1

        //var img = ['Romain.png','Benoit.png'];
        //function BenoitOuRomain() {
        //var nSize = img.length;
        //var nIndex = Math.floor((Math.random() * nSize+1));
        //doucument.body.style.background = "url("+img[nIndex]+")";
        //}

        //var imgCount = 3;
        //var dir = 'images/';
        //var randomCount = Math.round(Math.random() * (imgCount - 1)) +1;
        //var images = new Array
        //images[1] = "Romain.png",
        //images[2] = "Benoit.png",
        //images[3] = "Alexandre.png",
        //document.getElementById("photo").style.backgroundImage = "url(" + dir + images[randomCount] + ")";


            function randomTime(min, max) {
                return Math.round(Math.random() * (max - min) + min);
            }

            function randomTrou(trous) {
                const idx = Math.floor(Math.random() * trous.length); // Apparition aléatoire des trous
                const trou = trous[idx]; // On dit que ce qui apparait aléatoirement doit etre dans un trou
                if (trou === dernierTrou) { //si trou est utilisé plusieurs fois
                    return randomTrou(trous); // alors renvoyer la fonction
                }
                dernierTrou = trou; // On dit que le derniertrou est égal au trou utilisé
                return trou; // renvoyer trou
            }

            function apparait() { //Pour faire apparaitre les romains
                const time = randomTime(300, 1000); // les romains apparaissent entre 0.2 et 1 seconde
                const trou = randomTrou(trous); // on dit que trou apparait aléatoirement dans un des trous
                trou.classList.add('up'); // Pour faire monter romain
                setTimeout(() => {
                    trou.classList.remove('up');
                    if (!timeUp) apparait(); // Si le temps est pas fini (!) alors fait pooper des Romains
                }, time);
            }

            function startGame() { //Variable pour définir les paramètres du début du jeu
                scoreBoard.textContent = 0; //
                multiplie.textContent = 1;
                timeUp = false; // Pour redire qu'au lancement de la partie, le temps de la partie n'est pas terminé
                score = 0;
                multiplicateur = 1;
                apparait(); // Pour lancer la fonction apparait au démarrage
                setTimeout(() => timeUp = true, 20000); // La partie dure 20 secondes (20000)

            }

            function bonk(e) {
                if (!e.isTrusted) return; //Tricheur!
                score++; // Le score augmente quand on clique
                if (score >= 10) {
                    score += 2;
                    multiplicateur = 2;
                }
                if (score >= 30) {
                    score += 3;
                    multiplicateur = 3;
                }
                if (score >= 50) {
                    score += 4;
                    multiplicateur = 5;
                }
                if (score >= 80) {
                    score += 5;
                    multiplicateur = 6;
                }
                if (score >= 220) {
                    score += 6;
                    multiplicateur = 7;
                }
                if (score >= 280) {
                    score += 7;
                    multiplicateur = 8;
                }
                if (score >= 340) {
                    score += 8;
                    multiplicateur = 9;
                }
                if (score >= 400) {
                    score += 9;
                    multiplicateur = 10;
                }
                if (score >= 500) {
                    score += 29;
                    multiplicateur = 30;
                }
                this.parentNode.classList.remove('up');
                scoreBoard.textContent = score;
                multiplie.textContent = multiplicateur;
            }

            alert(
                "Tu es sur le point de casser la tronche à coup de marteau à des gens bien. \n\nSouhaites-tu réellement prendre ce risque au péril de ta vie ou en prennant la plus grosse punition DU MONDE?\n\nA toi de voir.\n\nTu as deux choix:\n\n-Ne pas jouer et ne pas risquer ta vie...\n-Péter la tronche à ces gens qui vont pop hors de terre et exploser le score!\n\nSi tu prends le risque de les frapper, je ne suis en rien concerné de ce déchainement de haine envers ces 3 braves hommes. Paix à ton âme, toi qui a choisi le côté obscure de la force. Béni soit le fruit. Mince, je vais trop loin dans les références.. BREF! Courage à toi, sombre fou qui ne passera pas !\n\n\nAh et j'oubliais aussi... Attrap.. attaque les tous"
            );
            /*
            //if (score <= 100) {
                //getElementById("image")= "images/romain.gif";
            //}
            //if (score >= 100) {
                //getElementById("image")= "images/romain.png";
            //}
            */

           romains.forEach(romain => romain.addEventListener('click', bonk));
           var audio = new Audio('musique.mp3');
           audio.play();

            romains.forEach(romain => romain.addEventListener('click', bonk));
    </script>
    <br>
    <br>



</body>

</html>
